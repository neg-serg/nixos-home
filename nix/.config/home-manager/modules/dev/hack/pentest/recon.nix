{pkgs, lib, config, ...}: let
  excluded = config.features.excludePkgs or [];
  notExcluded = p: let n = (p.pname or (lib.getName p)); in !(lib.elem n excluded);
  notBroken = p: !(((p.meta or {}).broken or false));
in {
  home.packages = lib.filter notBroken (lib.filter notExcluded (with pkgs; [
    # 0trace # A traceroute tool that can run within an existing TCP connection
    arping # Broadcasts a who-has ARP package on the network and prints answers
    # braa # Mass SNMP scanner
    # cdpsnarf # Network sniffer to extract CDP information
    # dmitry # Deepmagic Information Gathering Tool
    # Tool to find a company (target) infrastructure, files,
    # and apps on the top cloud providers (Amazon, Google,
    # Microsoft, DigitalOcean, Alibaba, Vultr, Linode)
    cloudbrute # brute-force cloud asset enumeration
    dnsenum # Perl script that enumerates DNS information
    dnsrecon # DNS Enumeration Script
    dnstracer # Trace DNS queries to the source
    # dnswalk # Checks dns zone information using nameserver lookups
    # Tool for enumerating information from Windows and Samba
    # systems. It attempts to offer similar functionality to
    # enum.exe formerly available from www.bindview.com
    enum4linux # SMB/Windows enumeration toolkit
    fierce # Domain DNS scanner
    # firewalk # Active reconnaissance network security tool
    # fragrouter # IDS evasion toolkit
    # ftester # Tool for testing firewalls and Intrusion Detection System (IDS)
    # Network tool able to send custom TCP/IP packets and to
    # display target replies like ping do with ICMP replies.
    # hping3 can handle fragmentation, and almost arbitrary
    # packet size and content, using the command line interface
    hping # craft and send arbitrary TCP/IP packets
    # ike-scan # Discover and fingerprint IKE hosts (IPsec VPN Servers)
    # intrace # Traceroute-like application piggybacking on existing TCP connections
    # irpas # Internetwork Routing Protocol Attack Suite
    # lbd # Load balancer detector
    # legion # Semi-automated network penetration testing tool
    # TCP port scanner, spews SYN packets asynchronously,
    # scanning entire Internet in under 5 minutes
    masscan # ultra-fast TCP port scanner
    # metagoofil # Tool designed for extracting metadata of public documents
    sn0int # Semi-automatic OSINT framework and package manager
    # qsslcaudit # Test SSL/TLS clients how secure they are
    # netdiscover # Active/passive network address scanner using ARP requests
    netmask # Helps determine network masks
    onesixtyone # Fast SNMP scanner
    # recon-ng # Web Reconnaissance framework written in Python
    # smbmap # SMB enumeration tool
    # smtp-user-enum # Username guessing tool primarily for the SMTP service
    net-snmp # SNMP service enumeration tool
    sslsplit # Transparent SSL/TLS interception
    ssldump # SSLv3/TLS network protocol analyzer
    sslh # Applicative protocol multiplexer
    sslscan # Fast SSL scanner
    # sslyze # Fast and full-featured SSL scanner
    swaks # SMTP command-line test tool
    # thc-ipv6 # The Hacker Choice's IPv6 Attack Toolkit
    # tlssled # Valuates the security of a target SSL/TLS (HTTPS) server
    # twofi # Twitter words of interest
    # unicornscan # Userland distributed TCP/IP stack
    # Generate and test domain typos and variations to detect
    # and perform typo squatting, URL hijacking, phishing, and
    # corporate espionage
    # urlcrazy
    # wafw00f # Identify and fingerprint Web Application Firewall products
    # xprobe # Remote OS identification
  ]));
}
